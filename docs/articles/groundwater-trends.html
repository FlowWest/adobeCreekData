<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Groundwater Trends • adobeCreekData</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Groundwater Trends">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">adobeCreekData</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/adobe-streamflow-model.html">Adobe Streamflow Model</a>
    </li>
    <li>
      <a href="../articles/groundwater-trends.html">Groundwater Trends</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="groundwater-trends_files/htmlwidgets-1.3/htmlwidgets.js"></script><script src="groundwater-trends_files/jquery-1.12.4/jquery.min.js"></script><link href="groundwater-trends_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="groundwater-trends_files/leaflet-1.3.1/leaflet.js"></script><link href="groundwater-trends_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="groundwater-trends_files/Proj4Leaflet-1.0.1/proj4-compressed.js"></script><script src="groundwater-trends_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="groundwater-trends_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="groundwater-trends_files/leaflet-binding-2.0.2/leaflet.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Groundwater Trends</h1>
            
      
      
      <div class="hidden name"><code>groundwater-trends.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(adobeCreekData)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyverse)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(leaflet)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(lubridate)</a></code></pre></div>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>In this article I explore groundwater elevation trends, we are mostly interested in elevation difference across 10 years, 5 years and recent year. We also only look at groundwater wells where data was reported recently (2018). The comparison will focus on the elevation for Fall values (August-November).</p>
</div>
<div id="groundwater-well-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#groundwater-well-selection" class="anchor"></a>Groundwater Well Selection</h2>
<p>We will focus on wells where a groundwater elevation was reported for 2018. This results in 23 candiate wells for analysis. This number will be smaller as we seek to make comparison across years.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">stations_with_recent_data &lt;-<span class="st"> </span>groundwater_stations <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span>(end_date) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2018</span>) </a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">elevation_data &lt;-<span class="st"> </span>groundwater_levels <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(site_code <span class="op">%in%</span><span class="st"> </span>stations_with_recent_data<span class="op">$</span>site_code) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="st">  </span><span class="kw">select</span>(site_code, <span class="dt">date =</span> measurement_date, wse)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">groundwater_stations <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span>(end_date) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2018</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html">leaflet</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html">addTiles</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html">addCircleMarkers</a></span>() </a></code></pre></div>
<div id="htmlwidget-b8a9dd0e010e0fd9338a" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-b8a9dd0e010e0fd9338a">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircleMarkers","args":[[38.96222,38.971933,38.987505,38.9884,38.993,38.994647,38.994679,38.997183,38.997506,39.00357,39.00404,39.0044,39.007004,39.005291,39.007381,39.009652,39.01281,38.94378,38.958677,38.96434,38.9766,39.018588,39.020175],[-122.867223,-122.895905,-122.866551,-122.8936,-122.8687,-122.894686,-122.82226,-122.841335,-122.877074,-122.84271,-122.848964,-122.8434,-122.839639,-122.838267,-122.822292,-122.838395,-122.861743,-122.861025,-122.854461,-122.851532,-122.82878,-122.881273,-122.850014],10,null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"#03F","fillOpacity":0.2},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[38.94378,39.020175],"lng":[-122.895905,-122.82226]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="elevation-differences" class="section level2">
<h2 class="hasAnchor">
<a href="#elevation-differences" class="anchor"></a>Elevation Differences</h2>
<div id="years" class="section level3">
<h3 class="hasAnchor">
<a href="#years" class="anchor"></a>10 years</h3>
<p>For the ten year difference I look at the 2018 elevation minus the 2008 elevation. Not all wells are represented in this difference, of the 23 only 21 have values for both 2008 and 2018.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">ten_year_difference &lt;-<span class="st"> </span>elevation_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw"><a href="http://lubridate.tidyverse.org/reference/month.html">month</a></span>(date) <span class="op">%in%</span><span class="st"> </span><span class="dv">8</span><span class="op">:</span><span class="dv">11</span>, <span class="kw"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span>(date) <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2018</span>, <span class="dv">2008</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">year =</span> <span class="kw"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span>(date)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>date) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="st">  </span><span class="kw">spread</span>(year, wse) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">difference =</span> <span class="st">`</span><span class="dt">2018</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">2008</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(difference))</a>
<a class="sourceLine" id="cb3-8" data-line-number="8"></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">ten_year_difference <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(difference)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">4</span>, <span class="dt">color=</span><span class="st">"#949494"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Elevation Change 2008 to 2018"</span>, </a>
<a class="sourceLine" id="cb3-12" data-line-number="12">       <span class="dt">x =</span> <span class="st">"Elevation Difference (feet)"</span>)</a></code></pre></div>
<p><img src="groundwater-trends_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">ten_year_difference_with_lat_long &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="st">  </span>ten_year_difference <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="st">  </span><span class="kw">left_join</span>(stations_with_recent_data, <span class="dt">by=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"site_code"</span>=<span class="st">"site_code"</span>))</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">difference_<span class="dv">2008</span>_<span class="dv">2018</span>_pal &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/leaflet/man/colorNumeric.html">colorNumeric</a></span>(<span class="st">"Spectral"</span>, </a>
<a class="sourceLine" id="cb4-6" data-line-number="6">                                         ten_year_difference_with_lat_long<span class="op">$</span>difference)</a>
<a class="sourceLine" id="cb4-7" data-line-number="7"></a>
<a class="sourceLine" id="cb4-8" data-line-number="8">ten_year_difference_with_lat_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html">leaflet</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html">addTiles</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html">addCircleMarkers</a></span>(<span class="dt">fillColor =</span> <span class="op">~</span><span class="kw">difference_2008_2018_pal</span>(difference), </a>
<a class="sourceLine" id="cb4-12" data-line-number="12">                   <span class="dt">color=</span><span class="st">"#666666"</span>, <span class="dt">weight =</span> <span class="dv">2</span>, <span class="dt">fillOpacity =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb4-13" data-line-number="13">                   <span class="dt">popup =</span> <span class="op">~</span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"Elevation Change: "</span>, <span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(difference, <span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/leaflet/man/addLegend.html">addLegend</a></span>(<span class="dt">values =</span> <span class="op">~</span>difference, <span class="dt">pal=</span>difference_<span class="dv">2008</span>_<span class="dv">2018</span>_pal)</a></code></pre></div>
<div id="htmlwidget-01eb0724cf143cfeeccb" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-01eb0724cf143cfeeccb">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircleMarkers","args":[[38.94378,38.958677,38.96434,38.9766,38.987505,38.9884,38.993,38.994647,38.994679,38.997183,38.997506,39.00357,39.00404,39.0044,39.007004,39.005291,39.007381,39.009652,39.01281,39.018588,39.020175],[-122.861025,-122.854461,-122.851532,-122.82878,-122.866551,-122.8936,-122.8687,-122.894686,-122.82226,-122.841335,-122.877074,-122.84271,-122.848964,-122.8434,-122.839639,-122.838267,-122.822292,-122.838395,-122.861743,-122.881273,-122.850014],10,null,null,{"interactive":true,"className":"","stroke":true,"color":"#666666","weight":2,"opacity":0.5,"fill":true,"fillColor":["#F8FCB4","#5E4FA2","#C6E89F","#E9F69C","#EAF79E","#FEDB87","#D0EC9D","#EFF9A6","#FECF7C","#C6E89F","#FFF6B0","#F1F9A8","#F3FAAC","#B4E1A2","#FFFCBA","#BFE5A0","#CFEB9D","#EFF9A6","#9E0142","#F9FDB5","#F7FCB3"],"fillOpacity":1},null,null,["Elevation Change: -2.6","Elevation Change: 20.1","Elevation Change: 3.5","Elevation Change: 0.3","Elevation Change: 0.1","Elevation Change: -9.3","Elevation Change: 2.7","Elevation Change: -0.9","Elevation Change: -10.5","Elevation Change: 3.5","Elevation Change: -5.4","Elevation Change: -1.2","Elevation Change: -1.6","Elevation Change: 4.9","Elevation Change: -4.5","Elevation Change: 4.1","Elevation Change: 2.8","Elevation Change: -0.9","Elevation Change: -28.1","Elevation Change: -2.8","Elevation Change: -2.5"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#9E0142 , #C12D4A 6.43153526970982%, #EA5F48 16.8049792531123%, #FB9D58 27.1784232365148%, #FED481 37.5518672199173%, #FFF9B4 47.9253112033197%, #EAF79F 58.2987551867222%, #B3E0A3 68.6721991701247%, #6EC5A5 79.0456431535272%, #378BBC 89.4190871369297%, #5E50A3 99.7925311203321%, #5E4FA2 "],"labels":["-25","-20","-15","-10","-5","0","5","10","15","20"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topright","type":"numeric","title":"difference","extra":{"p_1":0.0643153526970982,"p_n":0.997925311203321},"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[38.94378,39.020175],"lng":[-122.894686,-122.82226]}},"evals":[],"jsHooks":[]}</script><p>As is shown in the histogram most of values are close to zero, with two pontential outliers on both sides. To determine if these are in fact outliers we will need to explore differences across multiple decades. In the section below I do exactly this, iterate through all decades in the data compute differences at these wells.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">decade_differences &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map.html">map_df</a></span>(<span class="dv">1980</span><span class="op">:</span><span class="dv">2018</span>, <span class="cf">function</span>(y) {</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">  year1 &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">  year2 &lt;-<span class="st"> </span>y</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">  </a>
<a class="sourceLine" id="cb5-5" data-line-number="5">  elevation_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="st">    </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw"><a href="http://lubridate.tidyverse.org/reference/month.html">month</a></span>(date) <span class="op">%in%</span><span class="st"> </span><span class="dv">8</span><span class="op">:</span><span class="dv">11</span>, <span class="kw"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span>(date) <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(year1, year2)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">year =</span> <span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="kw"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span>(date) <span class="op">==</span><span class="st"> </span>year1, <span class="st">"start_year"</span>, <span class="st">"end_year"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="st">    </span><span class="kw">select</span>(<span class="op">-</span>date) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="st">    </span><span class="kw">group_by_at</span>(<span class="kw">vars</span>(<span class="op">-</span>wse)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># group by everything other than the value column. </span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">row_id=</span><span class="dv">1</span><span class="op">:</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="st">  </span><span class="kw">spread</span>(year, wse) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">difference =</span> end_year <span class="op">-</span><span class="st"> </span>start_year, </a>
<a class="sourceLine" id="cb5-13" data-line-number="13">           <span class="dt">diff_id =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(year1, <span class="st">"_"</span>, year2), </a>
<a class="sourceLine" id="cb5-14" data-line-number="14">           <span class="dt">end_year =</span> year2) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="st">    </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(difference))</a>
<a class="sourceLine" id="cb5-16" data-line-number="16">}) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(stations_with_recent_data, <span class="dt">by=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"site_code"</span>=<span class="st">"site_code"</span>))</a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">decade_differences <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(difference)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Decade Differences (feet)"</span>, </a>
<a class="sourceLine" id="cb6-4" data-line-number="4">       <span class="dt">title =</span> <span class="st">"Decade Elevation Changes (1980-2018)"</span>) </a></code></pre></div>
<p><img src="groundwater-trends_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>The above is showing all decade differences for all wells that have recent data. The shape is very similar to what we saw in the 2008 to 2018 change, the outliers however are just tail ends to this larger distribution.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">decade_differences_avg &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">  </span>decade_differences <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(site_code) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="st">  </span><span class="kw">summarise</span>(</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">    <span class="dt">avg_diff =</span> <span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(difference, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), </a>
<a class="sourceLine" id="cb7-6" data-line-number="6">    <span class="dt">lat =</span> <span class="kw">first</span>(lat), </a>
<a class="sourceLine" id="cb7-7" data-line-number="7">    <span class="dt">lng =</span> <span class="kw">first</span>(lng)</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">  )</a>
<a class="sourceLine" id="cb7-9" data-line-number="9"></a>
<a class="sourceLine" id="cb7-10" data-line-number="10">decade_differences_pal &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/leaflet/man/colorNumeric.html">colorNumeric</a></span>(<span class="st">"Spectral"</span>, </a>
<a class="sourceLine" id="cb7-11" data-line-number="11">                                       <span class="dt">domain =</span> decade_differences_avg<span class="op">$</span>avg_diff)</a>
<a class="sourceLine" id="cb7-12" data-line-number="12"></a>
<a class="sourceLine" id="cb7-13" data-line-number="13">decade_differences_avg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html">leaflet</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html">addTiles</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html">addCircleMarkers</a></span>(<span class="dt">fillColor =</span> <span class="op">~</span><span class="kw">decade_differences_pal</span>(avg_diff), </a>
<a class="sourceLine" id="cb7-17" data-line-number="17">                   <span class="dt">fillOpacity =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb7-18" data-line-number="18">                   <span class="dt">color =</span> <span class="st">"#666666"</span>, <span class="dt">weight =</span> <span class="dv">2</span>, </a>
<a class="sourceLine" id="cb7-19" data-line-number="19">                   <span class="dt">popup =</span> <span class="op">~</span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"Avg Difference: "</span>, <span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(avg_diff))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/leaflet/man/addLegend.html">addLegend</a></span>(<span class="dt">pal =</span> decade_differences_pal, <span class="dt">values =</span> <span class="op">~</span>avg_diff)</a></code></pre></div>
<div id="htmlwidget-86e5d0c29d81e5ed3c05" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-86e5d0c29d81e5ed3c05">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircleMarkers","args":[[38.94378,38.958677,38.96222,38.96434,38.971933,38.9766,38.987505,38.9884,38.993,38.994647,38.994679,38.997183,38.997506,39.00357,39.00404,39.0044,39.007004,39.005291,39.007381,39.009652,39.01281,39.018588,39.020175],[-122.861025,-122.854461,-122.867223,-122.851532,-122.895905,-122.82878,-122.866551,-122.8936,-122.8687,-122.894686,-122.82226,-122.841335,-122.877074,-122.84271,-122.848964,-122.8434,-122.839639,-122.838267,-122.822292,-122.838395,-122.861743,-122.881273,-122.850014],10,null,null,{"interactive":true,"className":"","stroke":true,"color":"#666666","weight":2,"opacity":0.5,"fill":true,"fillColor":["#B7E1A2","#FEE18D","#9E0142","#97D4A4","#D2ED9C","#FEE390","#5E4FA2","#F2FAAB","#5DB2AC","#97D4A4","#FEB668","#B6E1A2","#9ED8A4","#4FA0B4","#AADDA4","#4899B6","#F57345","#CAE99E","#FEC775","#FFFAB6","#F67948","#C4E79F","#F6FBB0"],"fillOpacity":1},null,null,["Avg Difference: 0","Avg Difference: -3","Avg Difference: -6","Avg Difference: 1","Avg Difference: 0","Avg Difference: -2","Avg Difference: 3","Avg Difference: -1","Avg Difference: 2","Avg Difference: 1","Avg Difference: -3","Avg Difference: 0","Avg Difference: 1","Avg Difference: 2","Avg Difference: 0","Avg Difference: 2","Avg Difference: -4","Avg Difference: 0","Avg Difference: -3","Avg Difference: -2","Avg Difference: -4","Avg Difference: 0","Avg Difference: -1"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#9E0142 , #B62248 4.36315557514324%, #E4554A 14.7516212302462%, #F99052 25.1400868853491%, #FECA78 35.5285525404521%, #FFF2AA 45.917018195555%, #EFF9A6 56.305483850658%, #BFE5A0 66.6939495057609%, #7CCAA5 77.0824151608638%, #4596B7 87.4708808159668%, #595CA8 97.8593464710697%, #5E4FA2 "],"labels":["-6","-5","-4","-3","-2","-1","0","1","2","3"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topright","type":"numeric","title":"avg_diff","extra":{"p_1":0.0436315557514324,"p_n":0.978593464710697},"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[38.94378,39.020175],"lng":[-122.895905,-122.82226]}},"evals":[],"jsHooks":[]}</script><p>We can explore if there is any trend in the data by plotting the these differences on a scatter plot.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">decade_differences <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(end_year, difference)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_smooth</span>()</a></code></pre></div>
<p><img src="groundwater-trends_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div id="years-1" class="section level3">
<h3 class="hasAnchor">
<a href="#years-1" class="anchor"></a>5 years</h3>
<p>For the 5 year difference I look at the elevation change between 2012 and 2017. The distrubution is once again clustered around 0. We can get a better picture of what a 5 year change looks like by iterating through all possible 5 year changes.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">five_year_difference &lt;-<span class="st"> </span>elevation_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw"><a href="http://lubridate.tidyverse.org/reference/month.html">month</a></span>(date) <span class="op">%in%</span><span class="st"> </span><span class="dv">8</span><span class="op">:</span><span class="dv">11</span>, <span class="kw"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span>(date) <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2017</span>, <span class="dv">2012</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">year =</span> <span class="kw"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span>(date)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>date) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="st">  </span><span class="kw">spread</span>(year, wse) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">difference =</span> <span class="st">`</span><span class="dt">2017</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">2012</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(difference))</a>
<a class="sourceLine" id="cb9-8" data-line-number="8"></a>
<a class="sourceLine" id="cb9-9" data-line-number="9">five_year_difference <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(difference)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">4</span>, <span class="dt">color=</span><span class="st">"#949494"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Elevation Change 2013 to 2018"</span>, </a>
<a class="sourceLine" id="cb9-12" data-line-number="12">       <span class="dt">x =</span> <span class="st">"Elevation Difference (feet)"</span>)</a></code></pre></div>
<p><img src="groundwater-trends_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">five_year_differences &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map.html">map_df</a></span>(<span class="dv">1980</span><span class="op">:</span><span class="dv">2018</span>, <span class="cf">function</span>(y) {</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">  year1 &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">  year2 &lt;-<span class="st"> </span>y</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">  </a>
<a class="sourceLine" id="cb10-5" data-line-number="5">  elevation_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="st">    </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw"><a href="http://lubridate.tidyverse.org/reference/month.html">month</a></span>(date) <span class="op">%in%</span><span class="st"> </span><span class="dv">8</span><span class="op">:</span><span class="dv">11</span>, <span class="kw"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span>(date) <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(year1, year2)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">year =</span> <span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="kw"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span>(date) <span class="op">==</span><span class="st"> </span>year1, <span class="st">"start_year"</span>, <span class="st">"end_year"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="st">    </span><span class="kw">select</span>(<span class="op">-</span>date) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="st">    </span><span class="kw">group_by_at</span>(<span class="kw">vars</span>(<span class="op">-</span>wse)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># group by everything other than the value column. </span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">row_id=</span><span class="dv">1</span><span class="op">:</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="st">  </span><span class="kw">spread</span>(year, wse) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">difference =</span> end_year <span class="op">-</span><span class="st"> </span>start_year, </a>
<a class="sourceLine" id="cb10-13" data-line-number="13">           <span class="dt">diff_id =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(year1, <span class="st">"_"</span>, year2), </a>
<a class="sourceLine" id="cb10-14" data-line-number="14">           <span class="dt">end_year =</span> year2) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="st">    </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(difference))</a>
<a class="sourceLine" id="cb10-16" data-line-number="16">})</a></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">five_year_differences <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(difference)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"5-year Differences (feet)"</span>, </a>
<a class="sourceLine" id="cb11-4" data-line-number="4">       <span class="dt">title =</span> <span class="st">"5-year Elevation Changes (1980-2018)"</span>) </a></code></pre></div>
<p><img src="groundwater-trends_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>The above is showing all decade differences for all wells that have recent data. The shape is very similar to what we saw in the 10 year difference, fairly symmetrical around 0. At first glance its pretty obvious that we would not have sufficient evidence to disprove a null hypothesis stating no change in elevation has happened.</p>
<p>We can explore if there is any trend in the data by plotting the these differences on a scatter plot.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">five_year_differences <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(end_year, difference)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_smooth</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">1980</span>, <span class="dv">2018</span>, <span class="dt">by =</span> <span class="dv">5</span>))</a></code></pre></div>
<p><img src="groundwater-trends_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div id="year-change" class="section level3">
<h3 class="hasAnchor">
<a href="#year-change" class="anchor"></a>1-year change</h3>
<p>Here I look at the change of elevation in one year. In this case I skip looking at a recent year and instead just look at all the cases where there was a subsequent years of the data. Here are the assumptions and requirements for this analysis:</p>
<ol style="list-style-type: decimal">
<li>site code must have recent data to at least 2018</li>
<li>only subsequent years of data will be taken into account</li>
<li>when attaching water year types to the fall difference we will always use the water year for September. For example even though the difference is from November 1980 to November 1981, the water year associated with this difference will be 1980.</li>
</ol>
<p><strong>How the difference is calcualted</strong></p>
<p>The difference is calculated by subtracting the “start year” (smaller of the years) from the “end year”. This means that a positive value indicates elevation increase and a negative value indicates elevation decrease. When looking at the plot, a point on 1980 shows the difference between 1979 and 1980. Lastly this subtraction is done on each well, so when looking the plot a single point shows the difference between two years at an individual site code. We can see the spread of the difference values for a given year by focusing on one year on the x-axis and observing the range of values on the y-axis.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">wy_types &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="st">  </span>waterYearType<span class="op">::</span>water_year_indices <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(location <span class="op">==</span><span class="st"> "Sacramento Valley"</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="dt">year =</span> WY, <span class="dt">type =</span> Yr_type)</a>
<a class="sourceLine" id="cb13-4" data-line-number="4"></a>
<a class="sourceLine" id="cb13-5" data-line-number="5">one_year_differences &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map.html">map_df</a></span>(<span class="dv">1948</span><span class="op">:</span><span class="dv">2018</span>, <span class="cf">function</span>(y) {</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">  <span class="co"># get the start and end years for the calcuation</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7">  year1 &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8">  year2 &lt;-<span class="st"> </span>y</a>
<a class="sourceLine" id="cb13-9" data-line-number="9">  </a>
<a class="sourceLine" id="cb13-10" data-line-number="10">  <span class="co"># filter the data to just these two years</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11">  d &lt;-<span class="st"> </span>elevation_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="st">    </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw"><a href="http://lubridate.tidyverse.org/reference/month.html">month</a></span>(date) <span class="op">%in%</span><span class="st"> </span><span class="dv">8</span><span class="op">:</span><span class="dv">11</span>, <span class="kw"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span>(date) <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(year1, year2)) </a>
<a class="sourceLine" id="cb13-13" data-line-number="13">  </a>
<a class="sourceLine" id="cb13-14" data-line-number="14">  <span class="co"># if there is no data for these two years do not do anything else</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15">  <span class="cf">if</span> (<span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(d) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb13-16" data-line-number="16">  d2 &lt;-<span class="st"> </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">year =</span> <span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="kw"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span>(date) <span class="op">==</span><span class="st"> </span>year1, <span class="st">"start_year"</span>, <span class="st">"end_year"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-18" data-line-number="18"><span class="st">    </span><span class="kw">select</span>(<span class="op">-</span>date) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19"><span class="st">    </span><span class="kw">group_by_at</span>(<span class="kw">vars</span>(<span class="op">-</span>wse)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># group by everything other than the value column. </span></a>
<a class="sourceLine" id="cb13-20" data-line-number="20"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">row_id=</span><span class="dv">1</span><span class="op">:</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-21" data-line-number="21"><span class="st">    </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-22" data-line-number="22"><span class="st">    </span><span class="kw">spread</span>(year, wse) </a>
<a class="sourceLine" id="cb13-23" data-line-number="23">  </a>
<a class="sourceLine" id="cb13-24" data-line-number="24">  <span class="cf">if</span> (<span class="op">!</span>(<span class="st">"end_year"</span> <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(d2))) <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb13-25" data-line-number="25">  <span class="cf">if</span> (<span class="op">!</span>(<span class="st">"start_year"</span> <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(d2))) <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb13-26" data-line-number="26">  </a>
<a class="sourceLine" id="cb13-27" data-line-number="27">  d2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-28" data-line-number="28"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">difference =</span> end_year <span class="op">-</span><span class="st"> </span>start_year, </a>
<a class="sourceLine" id="cb13-29" data-line-number="29">           <span class="dt">diff_id =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(year1, <span class="st">"_"</span>, year2)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-30" data-line-number="30"><span class="st">    </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(difference)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-31" data-line-number="31"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">end_year =</span> year2, </a>
<a class="sourceLine" id="cb13-32" data-line-number="32">           <span class="dt">start_year =</span> year1)</a>
<a class="sourceLine" id="cb13-33" data-line-number="33">}) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-34" data-line-number="34"><span class="st">  </span><span class="kw">left_join</span>(wy_types, <span class="dt">by =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"end_year"</span> =<span class="st"> "year"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-35" data-line-number="35"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">end_year_type =</span> type) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-36" data-line-number="36"><span class="st">  </span><span class="kw">left_join</span>(wy_types, <span class="dt">by =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"start_year"</span> =<span class="st"> "year"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-37" data-line-number="37"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">start_year_type =</span> type) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-38" data-line-number="38"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">year_type_change =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(start_year_type, <span class="st">" to "</span>, end_year_type))</a></code></pre></div>
<p><strong>By Water Year Type of End Year</strong></p>
<p>Here I color the code the points by the water year type of the end year. That is, when looking at the year 1980 the value indicates the difference between wells from 1979 to 1980 but the color shows the water year type for 1980.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">one_year_differences <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(end_year, difference, <span class="dt">color=</span>end_year_type)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Water Year Type of End Year"</span>)</a></code></pre></div>
<p><img src="groundwater-trends_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p><strong>By Water Year Type of Start Year</strong></p>
<p>Here I color the code the points by the water year type of the start year.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">one_year_differences <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(end_year, difference, <span class="dt">color=</span>start_year_type)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.7</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">"Water Year Type of Start Year"</span>)</a></code></pre></div>
<p><img src="groundwater-trends_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
<div id="distribution-of-elevation-changes" class="section level3">
<h3 class="hasAnchor">
<a href="#distribution-of-elevation-changes" class="anchor"></a>Distribution of Elevation Changes</h3>
<p>With the water years attached we can do some statistics using these as categorical variables. We are mainly interested in significant differences in elevation change as a result of the water year types. (right?)</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">one_year_differences <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(end_year_type, difference, <span class="dt">color=</span>end_year_type)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Year Type"</span>, <span class="dt">y =</span> <span class="st">"Elevation Change"</span>, </a>
<a class="sourceLine" id="cb16-5" data-line-number="5">       <span class="dt">title =</span> <span class="st">"Elevation Change Distribution by Water Year Types"</span>)</a></code></pre></div>
<p><img src="groundwater-trends_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div id="distribution-of-elevation-changes-by-water-year-transitions" class="section level3">
<h3 class="hasAnchor">
<a href="#distribution-of-elevation-changes-by-water-year-transitions" class="anchor"></a>Distribution of Elevation Changes by Water Year Transitions</h3>
<p>In this section I encode the <em>water year transition types</em>, that is I just keep track of the water year of the start year and the water year of the end year and add this as a column to the dataframe.</p>
<p><strong>Dry to Wet and Wet to Dry Transitions</strong></p>
<p>Here I focus on the Wet to Dry and Dry to Wet transitions.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">one_year_differences <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(year_type_change <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Wet to Dry"</span>, <span class="st">"Dry to Wet"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(difference, <span class="dt">fill=</span>year_type_change, <span class="dt">color=</span>year_type_change)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha=</span><span class="fl">0.5</span>)</a></code></pre></div>
<p><img src="groundwater-trends_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p><strong>Critical to Wet and Wet to Critical Transitions</strong></p>
<p>Here I focus on the Wet to Dry and Dry to Wet transitions.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">one_year_differences <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(year_type_change <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Wet to Critical"</span>, <span class="st">"Critical to Wet"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(difference, <span class="dt">fill=</span>year_type_change, <span class="dt">color=</span>year_type_change)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha=</span><span class="fl">0.5</span>)</a></code></pre></div>
<p><img src="groundwater-trends_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<div id="water-year-type-trends" class="section level3">
<h3 class="hasAnchor">
<a href="#water-year-type-trends" class="anchor"></a>Water Year Type Trends</h3>
<p>Are there any trends in difference values by water year?</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">one_year_differences <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(end_year_type <span class="op">==</span><span class="st"> "Critical"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(end_year, difference)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="groundwater-trends_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#groundwater-well-selection">Groundwater Well Selection</a></li>
      <li><a href="#elevation-differences">Elevation Differences</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Emanuel Rodriguez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
